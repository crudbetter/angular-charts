angular.module("piechart",[]).constant("piechartConfig",{radius:10}).value("createSVGNode",function(a,b,c){var d="http://www.w3.org/2000/svg",e=document.createElementNS(d,a);for(var f in c){var g=c[f];null===g||f.match(/\$/)||"string"==typeof g&&""===g||e.setAttribute(f,g)}return e}).controller("PiechartController",["$scope","$attrs","piechartConfig",function(a,b,c){var d,e,f=function(a,b){function c(a){return a*(Math.PI/180)}function d(a){return{x:Math.round(e*Math.cos(a)),y:Math.round(e*Math.sin(a))}}return{start:d(c(a)),end:d(c(b))}};this.slices=d=[],this.scope=a,this.attrs=b,this.addSlice=function(a){d.push(a)},this.removeSlice=function(a){d.splice(d.indexOf(a),1)},this.setArcs=function(){var g=0,h=0;e=angular.isDefined(b.radius)?a.$eval(b.radius):c.radius,angular.forEach(d,function(a){h+=a.value}),angular.forEach(d,function(a){a.radius=e,a.arc=f(g,g+=360/(h/a.value)),a.arc.large=a.value>h/2})}}]).directive("piechart",["createSVGNode",function(a){return{restrict:"EA",controller:"PiechartController",controllerAs:"ctrl",link:function(b,c,d){var e=a("svg",c,d);angular.element(e).append(c[0].childNodes),c.replaceWith(e)}}}]).directive("piechartSlice",["piechartConfig","createSVGNode","$compile",function(a,b,c){return{restrict:"EA",require:"?^piechart",scope:{value:"@"},link:function(a,d,e,f){var g=f||a.$parent.ctrl,h="M0,0L{{arc.start.x}},{{arc.start.y}}A{{radius}},{{radius}},1,{{arc.large ? 1 : 0}},1,{{arc.end.x}},{{arc.end.y}}Z",i="translate({{radius}},{{radius}})",j=b("path",d,e);angular.element(j).attr("ng-attr-d",h),angular.element(j).attr("ng-attr-transform",i),d.replaceWith(j),g.addSlice(a),e.$observe("value",function(b){a.value=parseInt(b,10),g.setArcs(),c(j)(a)})}}}]);