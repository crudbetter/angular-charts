angular.module("charts",["piechart","linechart"]),angular.module("piechart",[]).constant("piechartConfig",{radius:10}).controller("PiechartController",["$scope","$attrs","piechartConfig",function(a,b,c){var d,e=function(a,b){function c(a){return a*(Math.PI/180)}function d(a){return{x:1*Math.cos(a),y:1*Math.sin(a)}}return{start:d(c(a)),end:d(c(b))}};this.slices=d=[],this.addSlice=function(a){d.push(a)},this.removeSlice=function(a){d.splice(d.indexOf(a),1)},this.setArcs=function(){var f=0,g=0;a.radius=angular.isDefined(b.radius)?a.$eval(b.radius):c.radius,angular.forEach(d,function(a){g+=a.value}),angular.forEach(d,function(a){a.arc=e(f,f=(f+360/(g/a.value))%360),a.arc.large=a.value>g/2})}}]).directive("piechart",function(){return{restrict:"EA",replace:!0,controller:"PiechartController",template:'<svg ng-attr-height="{{radius * 2 + 10}}" ng-attr-width="{{radius * 2 + 10}}"><g ng-attr-transform="translate({{radius}}, {{radius}}), scale({{radius}})" ng-attr-stroke-width="{{1 / radius}}" ng-transclude></g></svg>',transclude:!0,scope:{radius:"@"}}}).directive("piechartSlice",function(){return{restrict:"EA",require:"^piechart",replace:!0,type:"svg",template:'<path ng-attr-d="M0,0L{{arc.start.x}},{{arc.start.y}}A1,1,1,{{arc.large ? 1 : 0}},1,{{arc.end.x}},{{arc.end.y}}Z" />',scope:{value:"@"},link:function(a,b,c,d){a.value=parseInt(a.value,10),d.addSlice(a),c.$observe("value",function(b){a.value=parseInt(b,10),d.setArcs()})}}}),angular.module("linechart",[]).factory("Point",function(){function a(a,b){this.x=a,this.y=b}return a.prototype.toString=function(){return this.x+","+this.y},a}).constant("linechartConfig",{height:200,width:300}).controller("LinechartController",["$scope","Point",function(a,b){var c;this.series=c=[],this.addSeries=function(a){c.push(a)},this.setLines=function(){var d=0,e=0;angular.forEach(c,function(a){a.values.length>e&&(e=a.values.length),angular.forEach(a.values,function(a){a>d&&(d=a)})}),angular.forEach(c,function(c){c.points=[],angular.forEach(c.values,function(f,g){var h=g*(a.width/(e-1)),i=f*(a.height/d);c.points.push(new b(h,i))})})}}]).directive("linechart",["linechartConfig",function(a){return{restrict:"EA",replace:!0,controller:"LinechartController",template:'<svg ng-attr-height="{{height + 10}}" ng-attr-width="{{width + 10}}"><g transform="translate(5, 5)"><line x1="0" y1="0" x2="0" ng-attr-y2="{{height}}" stroke="black" stroke-width="2"></line><line x1="0" ng-attr-y1="{{height}}" ng-attr-x2="{{width}}" ng-attr-y2="{{height}}" stroke="black" stroke-width="2"></line><g ng-attr-transform="translate(0, {{height}}), scale(1, -1)" ng-transclude></g></g></svg>',transclude:!0,scope:{h:"@h",w:"@w"},link:function(b){b.height=angular.isDefined(b.h)?b.$eval(b.h):a.height,b.width=angular.isDefined(b.w)?b.$eval(b.w):a.width}}}]).directive("linechartSeries",["$parse",function(a){return{restrict:"EA",require:"^linechart",replace:!0,type:"svg",template:"<polyline ng-attr-points=\"{{points.join(' ')}}\" />",scope:{vals:"@values"},link:function(b,c,d,e){var f=a(b.vals);b.values=f(),e.addSeries(b),b.$watchCollection("vals",function(){b.values=a(b.vals)(),e.setLines()})}}}]);