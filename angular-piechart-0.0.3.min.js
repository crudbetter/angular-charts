angular.module("piechart",[]).constant("piechartConfig",{radius:10}).controller("PiechartController",["$scope","$attrs","piechartConfig",function(a,b,c){var d,e=function(a,b){function c(a){return a*(Math.PI/180)}function d(a){return{x:1*Math.cos(a),y:1*Math.sin(a)}}return{start:d(c(a)),end:d(c(b))}};this.slices=d=[],this.addSlice=function(a){d.push(a)},this.removeSlice=function(a){d.splice(d.indexOf(a),1)},this.setArcs=function(){var f=0,g=0;a.radius=angular.isDefined(b.radius)?a.$eval(b.radius):c.radius,angular.forEach(d,function(a){g+=a.value}),angular.forEach(d,function(a){a.arc=e(f,f=(f+360/(g/a.value))%360),a.arc.large=a.value>g/2})}}]).directive("piechart",function(){return{restrict:"EA",replace:!0,controller:"PiechartController",template:'<svg ng-attr-height="{{radius * 2 + 10}}" ng-attr-width="{{radius * 2 + 10}}"><g ng-attr-transform="translate({{radius}}, {{radius}}), scale({{radius}})" ng-attr-stroke-width="{{1 / radius}}" ng-transclude></g></svg>',transclude:!0,scope:{radius:"@"}}}).directive("piechartSlice",function(){return{restrict:"EA",require:"^piechart",replace:!0,type:"svg",template:'<path ng-attr-d="M0,0L{{arc.start.x}},{{arc.start.y}}A1,1,1,{{arc.large ? 1 : 0}},1,{{arc.end.x}},{{arc.end.y}}Z" />',scope:{value:"@"},link:function(a,b,c,d){a.value=parseInt(a.value,10),d.addSlice(a),c.$observe("value",function(b){a.value=parseInt(b,10),d.setArcs()})}}});